namespace Skyline.DataMiner.Solutions.Categories.API
{
	using System;
	using System.Linq;

	public static class NameUtil
	{
		public static bool Validate(string name, out string error)
		{
			if (name == null)
			{
				error = "Name cannot be null.";
				return false;
			}

			if (String.IsNullOrWhiteSpace(name))
			{
				error = "Name cannot be whitespace or empty.";
				return false;
			}

			if (name.Length < 1 || name.Length > 100)
			{
				error = "Name must be between 1 and 100 characters long.";
				return false;
			}

			if (Char.IsWhiteSpace(name[0]) || Char.IsWhiteSpace(name[name.Length - 1]))
			{
				error = "Name cannot start or end with whitespace.";
				return false;
			}

			// Check for invalid characters
			if (name.Any(c => Char.IsControl(c) || c == '/' || c == '\\' || c == ';' || c == ',' || c == '|'))
			{
				error = "Name contains invalid or special characters.";
				return false;
			}

			error = null;
			return true;
		}
	}
}
